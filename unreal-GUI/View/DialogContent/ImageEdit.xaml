<UserControl x:Class="unreal_GUI.View.DialogContent.ImageEdit"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:local="clr-namespace:unreal_GUI.View.DialogContent"
             xmlns:ui="http://schemas.inkore.net/lib/ui/wpf/modern"
             xmlns:converters="clr-namespace:unreal_GUI.Converters"
             mc:Ignorable="d">

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- 第一行：标题区域 -->
        <StackPanel x:Name="TitlePanel" Grid.Row="0" Margin="20,20,20,10">
            <TextBlock Text="图片剪裁工具" FontSize="20" FontWeight="Bold" />
            <TextBlock Text="本工具用于将图片剪裁为3:1比例，适用于类别(Categories)图标。" 
                       Margin="0,5,0,0" 
                       FontSize="14" 
                       Foreground="{DynamicResource TextFillColorSecondaryBrush}"/>
        </StackPanel>

        <!-- 第二行：图片展示区域 -->
        <Border x:Name="PicturePreviewBorder" 
                Grid.Row="1"
                Margin="20,10,20,10" 
                BorderThickness="1"
                BorderBrush="LightGray"
                CornerRadius="4">

            <!-- 图片展示网格 -->
            <Grid x:Name="ImageDisplayGrid">
                <!-- 图片展示框 -->
                <Image Name="BackgroundImage" 
                       Stretch="Uniform" 
                       Panel.ZIndex="0"
                       HorizontalAlignment="Center"
                       VerticalAlignment="Center"/>

                <!-- 遮罩层Canvas -->
                <Canvas Name="CroppingCanvas" 
                        Background="Transparent" 
                        Panel.ZIndex="1"
                        HorizontalAlignment="Stretch"
                        VerticalAlignment="Stretch">

                    <!-- 显示剪裁区域的边框 -->
                    <Rectangle Name="ResizableRect"
                           Canvas.Left="{Binding RectLeft}"
                           Canvas.Top="{Binding RectTop}"
                           Width="{Binding RectWidth}"
                           Height="{Binding RectHeight}"
                           Fill="Transparent" 
                           Stroke="Black"
                           StrokeThickness="1"
                           MouseLeftButtonDown="ResizableRect_MouseLeftButtonDown"
                           MouseMove="ResizableRect_MouseMove"
                           MouseLeftButtonUp="ResizableRect_MouseLeftButtonUp"/>

                    <!-- 四边热区（透明），用于拖拽调整大小 -->
                    <Rectangle Name="EdgeTop" 
                           Canvas.Left="{Binding EdgeTopLeft}"
                           Canvas.Top="{Binding EdgeTopTop}"
                           Width="{Binding EdgeTopWidth}"
                           Height="{Binding EdgeTopHeight}"
                           Fill="Transparent" 
                           Cursor="SizeNS"
                           MouseLeftButtonDown="Edge_MouseLeftButtonDown"
                           MouseMove="Edge_MouseMove"
                           MouseLeftButtonUp="Edge_MouseLeftButtonUp"/>
                    <Rectangle Name="EdgeBottom" 
                           Canvas.Left="{Binding EdgeBottomLeft}"
                           Canvas.Top="{Binding EdgeBottomTop}"
                           Width="{Binding EdgeBottomWidth}"
                           Height="{Binding EdgeBottomHeight}"
                           Fill="Transparent" 
                           Cursor="SizeNS"
                           MouseLeftButtonDown="Edge_MouseLeftButtonDown"
                           MouseMove="Edge_MouseMove"
                           MouseLeftButtonUp="Edge_MouseLeftButtonUp"/>
                    <Rectangle Name="EdgeLeft" 
                           Canvas.Left="{Binding EdgeLeftLeft}"
                           Canvas.Top="{Binding EdgeLeftTop}"
                           Width="{Binding EdgeLeftWidth}"
                           Height="{Binding EdgeLeftHeight}"
                           Fill="Transparent" 
                           Cursor="SizeWE"
                           MouseLeftButtonDown="Edge_MouseLeftButtonDown"
                           MouseMove="Edge_MouseMove"
                           MouseLeftButtonUp="Edge_MouseLeftButtonUp"/>
                    <Rectangle Name="EdgeRight" 
                           Canvas.Left="{Binding EdgeRightLeft}"
                           Canvas.Top="{Binding EdgeRightTop}"
                           Width="{Binding EdgeRightWidth}"
                           Height="{Binding EdgeRightHeight}"
                           Fill="Transparent" 
                           Cursor="SizeWE"
                           MouseLeftButtonDown="Edge_MouseLeftButtonDown"
                           MouseMove="Edge_MouseMove"
                           MouseLeftButtonUp="Edge_MouseLeftButtonUp"/>
                </Canvas>
            </Grid>
        </Border>

        <!-- 第三行：图片信息 -->
        <Grid x:Name="InfoGrid" 
              Grid.Row="2"
              Margin="20,10,20,10">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto" />
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="Auto" />
            </Grid.ColumnDefinitions>

            <!-- 图片尺寸信息 -->
            <StackPanel Orientation="Horizontal" Grid.Column="0">
                <TextBlock Text="尺寸: " FontSize="14" VerticalAlignment="Center"/>
                <StackPanel Orientation="Horizontal" VerticalAlignment="Center" Margin="10,0,0,0">
                    <TextBlock Text="{Binding ImageWidth}" 
                               FontSize="14" 
                               VerticalAlignment="Center"/>
                    <TextBlock Text=" × " 
                               FontSize="14" 
                               VerticalAlignment="Center"
                               Margin="5,0"/>
                    <TextBlock Text="{Binding ImageHeight}" 
                               FontSize="14" 
                               VerticalAlignment="Center"/>
                </StackPanel>
            </StackPanel>

            <!-- 剪裁比例信息 -->
            <TextBlock Grid.Column="2" 
                       Text="剪裁比例: 3:1" 
                       FontSize="14" 
                       VerticalAlignment="Center"
                       Foreground="{DynamicResource TextFillColorSecondaryBrush}"/>
        </Grid>

        <!-- 第四行：底部按钮 -->
        <Grid x:Name="ControlGrid" 
              Grid.Row="3"
              Margin="0,10,0,0" VerticalAlignment="Top">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="Auto" />
                <ColumnDefinition Width="Auto" />
                <ColumnDefinition Width="Auto" />
            </Grid.ColumnDefinitions>

            <!-- 左侧按钮区域 -->


            <!-- 右侧按钮区域 -->
            <StackPanel Grid.Column="0" Orientation="Horizontal" Margin="20,0,0,0">
                <CheckBox x:Name="PNGCompressCheckBox" 
                       Content="启用压缩" 
                      IsChecked="True"
                       Margin="0,0,10,0" HorizontalAlignment="Left"/>
            </StackPanel>

            <!--<StackPanel Grid.Column="1" Orientation="Horizontal" Margin="10,0,0,0">
                <Button x:Name="FinishCropButton" 
                       Content="完成剪裁" 
                    Style="{DynamicResource AccentButtonStyle}"
                       Click="FinishCropButton_Click" HorizontalAlignment="Right" Margin="0,0,20,0"/>
            </StackPanel>-->

        </Grid>
    </Grid>
</UserControl>